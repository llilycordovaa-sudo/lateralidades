<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âœ… VERIFICACIÃ“N SISTEMA RESTAURADO</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
        }
        .container { 
            max-width: 1000px; 
            margin: 0 auto; 
            background: rgba(255,255,255,0.1); 
            padding: 30px; 
            border-radius: 15px; 
            backdrop-filter: blur(10px); 
        }
        .panel { 
            background: rgba(255,255,255,0.08); 
            padding: 20px; 
            margin: 15px 0; 
            border-radius: 10px; 
            border: 1px solid rgba(255,255,255,0.2); 
        }
        .status { 
            padding: 10px 15px; 
            margin: 8px 0; 
            border-radius: 8px; 
            font-weight: bold; 
            display: flex; 
            align-items: center; 
            gap: 10px; 
        }
        .status.ok { background: rgba(76, 175, 80, 0.3); border: 1px solid #4CAF50; }
        .status.error { background: rgba(244, 67, 54, 0.3); border: 1px solid #f44336; }
        .status.warning { background: rgba(255, 193, 7, 0.3); border: 1px solid #FFC107; }
        .status.info { background: rgba(33, 150, 243, 0.3); border: 1px solid #2196F3; }
        button { 
            background: #4CAF50; 
            color: white; 
            border: none; 
            padding: 12px 25px; 
            border-radius: 8px; 
            cursor: pointer; 
            font-size: 16px; 
            font-weight: bold; 
            margin: 10px; 
            transition: all 0.3s; 
        }
        button:hover { 
            background: #45a049; 
            transform: translateY(-2px); 
            box-shadow: 0 5px 15px rgba(0,0,0,0.3); 
        }
        .log { 
            background: rgba(0,0,0,0.8); 
            color: #0f0; 
            padding: 15px; 
            font-family: monospace; 
            font-size: 12px; 
            border-radius: 8px; 
            max-height: 300px; 
            overflow-y: auto; 
            margin: 15px 0; 
        }
        h1 { 
            text-align: center; 
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5); 
            margin-bottom: 30px; 
        }
        h2 { 
            color: #fff; 
            border-bottom: 2px solid rgba(255,255,255,0.3); 
            padding-bottom: 10px; 
        }
        .grid { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 20px; 
        }
        @media (max-width: 768px) { 
            .grid { grid-template-columns: 1fr; } 
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>âœ… VERIFICACIÃ“N SISTEMA RESTAURADO</h1>
        <p style="text-align: center; font-size: 18px; margin-bottom: 30px;">
            ğŸ”„ Sistema restaurado desde backup funcional original
        </p>
        
        <div class="grid">
            <div class="panel">
                <h2>ğŸ” Estado del Sistema</h2>
                <div id="status-carga" class="status info">ğŸ“¡ Verificando carga...</div>
                <div id="status-funciones" class="status info">ğŸ”§ Verificando funciones...</div>
                <div id="status-actividades" class="status info">ğŸ­ Verificando actividades...</div>
                <div id="status-laboratorio" class="status info">ğŸ§ª Verificando laboratorio...</div>
                
                <button onclick="verificarSistemaCompleto()">ğŸ” VERIFICAR TODO</button>
                <button onclick="probarLaboratorio()">ğŸ§ª PROBAR LABORATORIO</button>
            </div>
            
            <div class="panel">
                <h2>ğŸ® Pruebas Funcionales</h2>
                <button onclick="probarActividad1()">ğŸ­ Probar Actividad 1</button>
                <button onclick="probarActividad2()">ğŸ  Probar Actividad 2</button>
                <button onclick="probarActividad3()">ğŸ‘¥ Probar Actividad 3</button>
                <button onclick="probarActividad4()">ğŸ“– Probar Actividad 4</button>
                <button onclick="limpiarLog()">ğŸ§¹ Limpiar Log</button>
            </div>
        </div>
        
        <div class="panel">
            <h2>ğŸ“Š Log de VerificaciÃ³n</h2>
            <div id="log" class="log">Sistema iniciando verificaciÃ³n...</div>
        </div>
    </div>

    <script src="js/actividades-interactivas.js"></script>
    
    <script>
        function log(mensaje) {
            const logDiv = document.getElementById('log');
            const tiempo = new Date().toLocaleTimeString();
            logDiv.innerHTML += `[${tiempo}] ${mensaje}\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
            console.log(mensaje);
        }
        
        function updateStatus(id, tipo, mensaje) {
            const elemento = document.getElementById(id);
            elemento.className = `status ${tipo}`;
            elemento.innerHTML = mensaje;
        }

        function verificarSistemaCompleto() {
            log('ğŸ” === VERIFICACIÃ“N COMPLETA DEL SISTEMA RESTAURADO ===');
            
            // 1. Verificar carga
            updateStatus('status-carga', 'ok', 'âœ… JavaScript cargado correctamente');
            log('âœ… Archivo JavaScript cargado desde backup');
            
            // 2. Verificar funciones crÃ­ticas
            const funcionesCriticas = {
                'activarHerramientaMancha': window.activarHerramientaMancha,
                'limpiarManchaPersonal': window.limpiarManchaPersonal,
                'guardarManchaPersonal': window.guardarManchaPersonal,
                'inicializarMiniSimulador': window.inicializarMiniSimulador,
                'mostrarActividad': window.mostrarActividad,
                'ACTIVIDADES_CONFIG': window.ACTIVIDADES_CONFIG,
                'ActividadState': window.ActividadState
            };
            
            let funcionesOK = 0;
            let totalFunciones = Object.keys(funcionesCriticas).length;
            
            for (const [nombre, funcion] of Object.entries(funcionesCriticas)) {
                if (funcion) {
                    log(`âœ… ${nombre}: DISPONIBLE (${typeof funcion})`);
                    funcionesOK++;
                } else {
                    log(`âŒ ${nombre}: FALTANTE`);
                }
            }
            
            if (funcionesOK === totalFunciones) {
                updateStatus('status-funciones', 'ok', `âœ… Todas las funciones OK (${funcionesOK}/${totalFunciones})`);
            } else {
                updateStatus('status-funciones', 'error', `âŒ Funciones faltantes (${funcionesOK}/${totalFunciones})`);
            }
            
            // 3. Verificar configuraciÃ³n de actividades
            if (window.ACTIVIDADES_CONFIG) {
                const actividades = Object.keys(window.ACTIVIDADES_CONFIG);
                log(`âœ… Actividades configuradas: ${actividades.join(', ')}`);
                updateStatus('status-actividades', 'ok', `âœ… ${actividades.length} actividades disponibles`);
                
                // Verificar cada actividad
                actividades.forEach(actId => {
                    const act = window.ACTIVIDADES_CONFIG[actId];
                    log(`   ğŸ“‹ ${actId}: "${act.titulo}" - ${act.fases.length} fases`);
                });
            } else {
                updateStatus('status-actividades', 'error', 'âŒ ConfiguraciÃ³n de actividades no encontrada');
            }
            
            // 4. Verificar estado del laboratorio
            if (window.ActividadState) {
                log('âœ… ActividadState inicializado correctamente');
                updateStatus('status-laboratorio', 'ok', 'âœ… Estado del laboratorio OK');
            } else {
                updateStatus('status-laboratorio', 'error', 'âŒ Estado del laboratorio no inicializado');
            }
            
            log('ğŸ‰ VerificaciÃ³n completa finalizada');
        }

        function probarLaboratorio() {
            log('ğŸ§ª === PRUEBA DEL LABORATORIO ===');
            
            try {
                // Simular carga de actividad 1
                if (window.mostrarActividad) {
                    log('ğŸ”§ Simulando carga de Actividad 1...');
                    window.mostrarActividad(1);
                    
                    setTimeout(() => {
                        // Verificar si se cargÃ³ el contenido
                        const contenido = document.getElementById('fase-contenido');
                        if (contenido && contenido.innerHTML.includes('Manchas')) {
                            log('âœ… Actividad 1 cargada correctamente');
                            
                            // Probar herramientas si estÃ¡n disponibles
                            setTimeout(() => {
                                const botonesHerramientas = document.querySelectorAll('.btn-herramienta');
                                log(`ğŸ”§ Herramientas disponibles: ${botonesHerramientas.length}`);
                                
                                if (botonesHerramientas.length > 0) {
                                    log('âœ… Laboratorio de herramientas operativo');
                                } else {
                                    log('âš ï¸ Herramientas no encontradas (puede estar en fase inicial)');
                                }
                            }, 1000);
                        } else {
                            log('âŒ Error cargando actividad 1');
                        }
                    }, 1500);
                } else {
                    log('âŒ FunciÃ³n mostrarActividad no disponible');
                }
            } catch (error) {
                log(`ğŸ’¥ Error en prueba del laboratorio: ${error.message}`);
            }
        }

        function probarActividad1() {
            log('ğŸ­ Probando Actividad 1: Somos Manchas que se Mueven');
            if (window.mostrarActividad) {
                window.mostrarActividad(1);
                log('âœ… Actividad 1 iniciada');
            } else {
                log('âŒ No se puede iniciar Actividad 1');
            }
        }

        function probarActividad2() {
            log('ğŸ  Probando Actividad 2: El Lugar que me Habita');
            if (window.mostrarActividad) {
                window.mostrarActividad(2);
                log('âœ… Actividad 2 iniciada');
            } else {
                log('âŒ No se puede iniciar Actividad 2');
            }
        }

        function probarActividad3() {
            log('ğŸ‘¥ Probando Actividad 3: Retrato Colectivo');
            if (window.mostrarActividad) {
                window.mostrarActividad(3);
                log('âœ… Actividad 3 iniciada');
            } else {
                log('âŒ No se puede iniciar Actividad 3');
            }
        }

        function probarActividad4() {
            log('ğŸ“– Probando Actividad 4: Historias del Error');
            if (window.mostrarActividad) {
                window.mostrarActividad(4);
                log('âœ… Actividad 4 iniciada');
            } else {
                log('âŒ No se puede iniciar Actividad 4');
            }
        }

        function limpiarLog() {
            document.getElementById('log').innerHTML = 'Log limpiado...\n';
        }

        // Auto-verificar cuando cargue
        window.addEventListener('load', function() {
            log('ğŸš€ Sistema de verificaciÃ³n cargado');
            setTimeout(() => {
                verificarSistemaCompleto();
            }, 1000);
        });
        
        // Capturar errores
        window.addEventListener('error', function(e) {
            log(`ğŸ’¥ Error detectado: ${e.message} en ${e.filename}:${e.lineno}`);
            updateStatus('status-carga', 'error', 'âŒ Error de JavaScript detectado');
        });
    </script>
</body>
</html>
